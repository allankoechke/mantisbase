@page rest_api REST API Reference Guide

MantisBase provides auto-generated RESTful APIs for interacting with database tables and views. This document covers the default API structure, supported HTTP methods, authentication handling, and customization options.

---

## üåê Base URL

When MantisBase is running locally:

```
http://localhost:7070/api/
```

You can configure the port and base path by passing in the commandline args to the `serve` subcommand as:

```
mantisbase serve -p 8000 -h 127.0.0.1
```

Check on the [CLI args](01.cmd.md) for more options on changing default values.

---

## üìÑ REST API Endpoints

MantisBase automatically exposes the following endpoints for each table or view:

| Method | Endpoint                    | Description                    |
|--------|-----------------------------|--------------------------------|
| GET    | `/api/v1/<table>`              | List all records               |
| GET    | `/api/v1/<table>/:id`          | Get a specific record          |
| POST   | `/api/v1/<table>`              | Create a new record            |
| PATCH  | `/api/v1/<table>/:id`          | Update partial fields          |
| DELETE | `/api/v1/<table>/:id`          | Delete a record                |
| POST | `/api/v1/<table>/auth-with-password`          | Authenticate user for `auth` tables              |

---

## üîê Authentication

If auth is enabled, all API calls must include a valid JWT in the `Authorization` header:

```
Authorization: Bearer <token>
```

### Auth Endpoints

Check above [Rest API](#-rest-api-endpoints) section above.

---

## üéõÔ∏è Filtering & Query Parameters [PENDING]

APIs support filtering, sorting, and pagination:

```
GET /api/v1/tasks?status=done&limit=10&offset=20&sort=-created_at
```

- `limit`, `offset` ‚Äì pagination
- `sort` ‚Äì sort by field (`-` prefix for descending)
- Field filters ‚Äì simple equality filters via query string

---

## ‚öôÔ∏è API Customization [In Dev]

You can create custom API endpoints to customize behaviour or add missing functionality by invoking the `router()`'s `Get/Post/Patch/Delete` methods from C++. Check the [example/main.cpp] on how to do that.

What can't you do currently?
- Add other hooks to existing autogenerated routes

---

## üóÉÔ∏è System Tables API

You can also interact with system tables to introspect schema or access logs:

- GET/POST/PATCH/DELETE/etc. `/api/v1/tables`
- GET/POST/PATCH/DELETE/etc. `/api/v1/admins`

> ‚ö†Ô∏è Access to system tables may be restricted to admin users ONLY.

---

## üóÉÔ∏è Middlewares

By default, all tables have two middlewares applied to:
- `getToken()` to extract token into request context.
- `hasAccess()` to evaluate access rules against logged in user.

> ‚ö†Ô∏è The access expression is applied to whole table, that is, each table has to define rules for 'getRule, addRule, listRule, deleteRule and updateRule`.

---

## üß™ Example Requests

```bash
# List tasks
curl http://localhost:7070/api/v1/tasks

# Create task
curl -X POST http://localhost:8080/api/v1/tasks   -H "Authorization: Bearer <token>"   -H "Content-Type: application/json"   -d '{"title": "Write API docs", "status": "in_progress"}'
```

---

## üèÅ Summary

MantisBase provides zero-setup APIs for all your structured data. With support for CRUD, authentication, query filtering, and future extensions, it's a ready-to-use backend interface for apps, tools, and embedded systems.

